ALZHEIMER'S MICROGLIA META-ANALYSIS - NEW STRUCTURE
====================================================

alzheimers_microglia_meta_analysis/
â”‚
â”œâ”€â”€ ğŸ“¦ PYTHON PACKAGE (src/)
â”‚   â””â”€â”€ src/ad_microglia/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ config/               # Configuration management
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â””â”€â”€ settings.py       # Centralized settings with get_settings()
â”‚       â”œâ”€â”€ data/                 # Data handling modules
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ download.py       # GEO dataset download
â”‚       â”‚   â”œâ”€â”€ preprocessing.py  # QC, normalization, scaling
â”‚       â”‚   â””â”€â”€ loaders.py        # Data loading utilities
â”‚       â”œâ”€â”€ integration/          # Dataset integration
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â””â”€â”€ integration.py    # scVI, Scanorama methods
â”‚       â”œâ”€â”€ analysis/             # Analysis modules
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ cell_annotation.py
â”‚       â”‚   â”œâ”€â”€ activation_states.py
â”‚       â”‚   â””â”€â”€ meta_analysis.py
â”‚       â””â”€â”€ utils/                # Utility modules
â”‚           â”œâ”€â”€ __init__.py
â”‚           â””â”€â”€ plot_manager.py   # Centralized plot management
â”‚
â”œâ”€â”€ ğŸ”§ EXECUTABLE SCRIPTS (scripts/)
â”‚   â”œâ”€â”€ 01_download_data.py
â”‚   â”œâ”€â”€ 02_preprocess_data.py
â”‚   â”œâ”€â”€ 03_annotate_cells.py
â”‚   â”œâ”€â”€ 04_integrate_datasets.py
â”‚   â”œâ”€â”€ 05_analyze_activation_states.py
â”‚   â”œâ”€â”€ 06_run_meta_analysis.py
â”‚   â””â”€â”€ run_full_pipeline.py      # Main pipeline runner
â”‚
â”œâ”€â”€ ğŸ§ª TESTS (tests/)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py               # Pytest configuration
â”‚   â”œâ”€â”€ test_data/                # Test fixtures
â”‚   â”œâ”€â”€ test_pipeline.py
â”‚   â””â”€â”€ test_quick.py
â”‚
â”œâ”€â”€ âš™ï¸ CONFIGURATION (config/)
â”‚   â”œâ”€â”€ datasets.yaml             # Dataset metadata & references
â”‚   â””â”€â”€ analysis_params.yaml      # QC, clustering, DE parameters
â”‚
â”œâ”€â”€ ğŸ“Š DATA (unchanged)
â”‚   â”œâ”€â”€ data/raw/                 # Downloaded GEO datasets
â”‚   â”œâ”€â”€ data/processed/           # Processed .h5ad files
â”‚   â””â”€â”€ data/metadata/            # Metadata JSON files
â”‚
â”œâ”€â”€ ğŸ“ˆ RESULTS (unchanged)
â”‚   â”œâ”€â”€ results/figures/          # Analysis plots
â”‚   â”œâ”€â”€ results/tables/           # Statistical results
â”‚   â”œâ”€â”€ results/reports/          # Summary reports
â”‚   â””â”€â”€ results/meta_analysis/    # Meta-analysis outputs
â”‚
â”œâ”€â”€ ğŸ““ NOTEBOOKS (new)
â”‚   â”œâ”€â”€ notebooks/exploratory/    # Exploratory analysis
â”‚   â””â”€â”€ notebooks/publication/    # Publication figures
â”‚
â”œâ”€â”€ ğŸ“š DOCUMENTATION (docs/)
â”‚   â”œâ”€â”€ api/                      # API documentation
â”‚   â”œâ”€â”€ tutorials/                # User guides
â”‚   â”œâ”€â”€ installation.md           # Installation guide
â”‚   â”œâ”€â”€ migration_guide.md        # Migration instructions
â”‚   â””â”€â”€ analysis_protocol.md      # Analysis methodology
â”‚
â”œâ”€â”€ ğŸ“‹ PACKAGE CONFIGURATION
â”‚   â”œâ”€â”€ pyproject.toml            # Modern Python packaging (PEP 518)
â”‚   â”œâ”€â”€ setup.py                  # Backward compatibility
â”‚   â”œâ”€â”€ requirements.txt          # Core dependencies
â”‚   â”œâ”€â”€ requirements-dev.txt      # Development dependencies
â”‚   â”œâ”€â”€ .env.example              # Environment template
â”‚   â””â”€â”€ .gitignore                # Comprehensive exclusions
â”‚
â””â”€â”€ ğŸ“– DOCUMENTATION FILES
    â”œâ”€â”€ README.md                 # Project overview (updated)
    â”œâ”€â”€ CHANGELOG.md              # Version history
    â”œâ”€â”€ RESTRUCTURE_SUMMARY.md    # Restructuring details
    â”œâ”€â”€ NEXT_STEPS.md             # Quick start guide
    â”œâ”€â”€ PLOT_MANAGEMENT.md        # Plot system docs
    â””â”€â”€ LICENSE                   # Project license

LEGACY (preserved for reference):
â”œâ”€â”€ scripts/preprocessing/        # Old preprocessing scripts
â”œâ”€â”€ scripts/analysis/             # Old analysis scripts  
â”œâ”€â”€ scripts/integration/          # Old integration scripts
â””â”€â”€ scripts/utils/                # Old utils

KEY IMPROVEMENTS:
=================

âœ… Proper src/ package layout (PEP 518 compliant)
âœ… Clean imports (no sys.path hacks)
âœ… Centralized configuration (YAML + env vars + Settings class)
âœ… Installable package (pip install -e .)
âœ… Comprehensive .gitignore
âœ… Pytest infrastructure
âœ… Development tools ready (black, flake8, mypy)
âœ… Professional documentation
âœ… Separation of concerns (src vs scripts vs tests)
âœ… 100% backward compatible with existing data/results

INSTALLATION:
============

1. Create virtual environment:
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate

2. Install package:
   pip install -e .

3. Configure (optional):
   cp .env.example .env

4. Run pipeline:
   python scripts/run_full_pipeline.py

USAGE EXAMPLES:
==============

# Import package modules
from ad_microglia.config import get_settings
from ad_microglia.data.preprocessing import DataPreprocessor
from ad_microglia.utils import PlotManager

# Use centralized settings
settings = get_settings()
print(settings.QC_MIN_GENES)
print(settings.RAW_DATA_DIR)

# Run preprocessing
preprocessor = DataPreprocessor()
preprocessor.process_dataset('data/raw/GSE98969', 'GSE98969')

# Create plots
plot_mgr = PlotManager()
fig, ax = plt.subplots()
plot_mgr.save_plot(fig, 'my_plot', 'qc', 'Description')

